**Read this in English: [English](README.md)**  

# 🏦 OutStake -- 完全围绕原生收益构建

_不仅仅是原生收益质押协议_

**Outstake** 是一个完全围绕原生收益代币构建的的协议，我们首个提出了一种与原生收益率挂钩的非美元稳定币模型，相比于目前市场上的其他收益代币协议（如 **Pendle**）更加灵活，可组合性更强，同时为提供了更高的收益率以及多种收益来源。**Outstake**支持的资产构成了 **Outrun** 生态系统的基础支撑，为整个生态系统提供了稳定的基础。 具体而言，**Outstake**的工作原理如下：

1. **基于原生收益代币的全新质押模型**：采用了不同于市场的全新设计，允许用户控制其资产产生的原生收益。通过 Outstake 可以铸造质押代币 PT 以解锁其质押资产的流动性，并在一系列 DeFi 应用程序中使用它们。
2. **原生收益稳定币（YT）**：原生收益稳定币的价值与对应代币的原生收益率直接挂钩。围绕它构建的经济模型为质押者提供了更高的收入和多种收入来源。它具有高度可组合性，允许开发人员围绕它创建新产品，从而丰富 Outrun 生态系统。
3. **通用资产本金代币（PT）**: 通用资产本金代币是通过质押**相同原生资产类型**的原生收益代币（如 Stone，stETH，rETH 等等）获得，质押相同原生资产类型的原生收益代币会铸造同一种通用资产本金代币，这样可以使相同原生资产类型下不同原生收益代币的 PT **流动性共享**，从而增强 PT 的可组合性，并且降低原生收益代币的流动性积累难度。
4. **仓位期权代币（POT）**：该期权代币代表原生收益代币的**锁定期到期赎回权**，通过该期权可以在不交易 PT 本身的情况下交易获得固定利率的权利，从而提高资本效率。

## 词汇表

**原生收益代币 (Native Yield Token)**

原生收益代币是一个泛指，指任何可以产生收益或者具有潜在收益的代币。例如，Stone，slisBNB，stETH，Blast ETH，GLP，LP 流动性代币等等。

**原生资产代币 (Native Asset Token)**

原生资产代币是指原生收益代币的底层资产代币。例如，Stone，stETH，rETH 对应的原生资产代币为 ETH。

**SY = 标准化生息代币 (Standardized Yield)**

SY 是一种基于 [ERC5115](https://eips.ethereum.org/EIPS/eip-5115) 标准的用于封装原生收益代币的金库代币，它可包装任何原生收益代币，并提供了一个标准化的接口，用于与任何原生收益代币的收益生成机制进行交互。

在 OutStake 种，质押 SY 并指定一个锁定时间会铸造 **POT**，**PT**，**YT** 三种代币。

**POT = 仓位期权代币 (Position Option Token)**

POT 是一种基于 [ERC1155](https://eips.ethereum.org/EIPS/eip-1155) 标准的用于封装用户质押仓位的期权代币，持有 POT 代表你握有仓位的到期赎回权，在 POT 锁定时间到期后，可以燃烧 POT 与 对应的 PT 从而赎回质押的原生收益代币。由于 POT 是 [ERC1155](https://eips.ethereum.org/EIPS/eip-1155) 标准的，所以支持仓位的部分赎回。

POT 记录了仓位的原生收益代币质押数量，恒定本金价值以及铸造的 PT 数量，因此其到期后燃烧的 POT 份额以及 PT 数量与所赎回的本金价值是一个固定的关系，从而形成固定的利率，通过交易 POT 可以交易获得固定利率的权利。

**PT = 本金代币 (Principal Token)**

PT 是由原生收益代币分拆出来的本金的组成部份。持有 PT 代表你握有本金的拥有权、并于 POT 到期后可兑换赎回原生收益代币。

不同于其他协议，OutStake 的 PT 是通用 ERC20 代币，没有过期时间。同时也是通用资产本金代币，质押相同资产类型的原生收益代币会铸造同一种通用资产本金代币，简单讲 质押 stETH，rETH，stone 会铸造同一种 PT 代币（相同代币合约地址），而非三种 PT 代币。

**YT = 收益代币 (Yield Token)**

YT 是由原生收益代币分拆出来的收益的组成部份。持有 YT 代表你拥有底层资产产生的所有收益，并且可以随时燃烧 YT 赎回当前收益池已积累的原生收益。

不同于其他协议，OutStake 的 YT 是通用 ERC20 代币，没有过期时间，不同质押时间所铸造的 YT 也是同一种代币（相同代币合约地址），与 PT 不同，每一种原生收益代币都会铸造对应的 YT。

YT 的可兑现价值（销毁 YT 赎回的原生收益）初始为 0，随着时间的推移，收益池会不断积累质押资产的原生收益，YT 的可兑现价值会不断增长，最终会达到一个动态平衡的状态，然后围绕原生收益代币的原生收益率波动。

## 收益率代币化

### SY

SY 是一种基于 [ERC5115](https://eips.ethereum.org/EIPS/eip-5115) 的用于封装原生收益代币的代币标准，实现了一种标准化的智能合约 API。所有原生收益代币都可以封装成 SY，从而为它们提供一个可建立的共同接口。

由于所有SY都具有相同的机制，OutStake 将 SY 作为与所有原生收益代币的主要接口进行交互。OutStake 能自动将原生收益代币转换为SY，反之亦然。这个过程在幕后自动进行，用户体验像直接与原生收益代币进行交互一样，而不需要手动处理 SY 与原生收益代币之间的转换。

### POT

POT(Position Options Token) 代表仓位的到期赎回权，用户在质押锁定原生收益资产时除了会铸造 PT 与 YT 以外，还会铸造 POT 封装用户的仓位。

POT 允许持有者在未来，也就是仓位锁定时间到期时，销毁固定数量的 PT 赎回固定数量的原生收益代币，通过交易 POT 可以交易获得固定利率的权利，而无需交易 PT 本身。

POT 由 [ERC1155](https://eips.ethereum.org/EIPS/eip-1155) 标准支持，将仓位分割为和 PT 铸造数量一样的份额，允许用户交易仓位的部分赎回权利。

### PT

PT 是质押 SY 而铸造的质押本金代币，旨在释放质押代币的流动性。用户质押 SY 时需要指定一个锁定时间从而铸造 PT，YT 以及 POT，PT 的数量并不是按质押的 SY 来 1 : 1 铸造的，而是与质押的时间（铸造的 YT 数量）以及原生收益代币相对于原生资产代币的**交换比率**相关，简单讲，先将原生收益代币的数量转换为对应价值的原生资产代币的数量，然后再使用以下算法计算：

<p align="center">
  <img src="./assets/PTAmount.png" alt="">
</p>

**YT redeemable value**（YT 可兑现价值）：销毁一个 YT 能赎回的原生收益。

所以 PT 的价值理论上与原生资产代币的价值挂钩，其总供应量将始终小于质押中的原生收益代币可交换的原生资产代币数量，从而保证 PT 的价值不会与原生资产代币的价值大幅度脱钩。

随着时间的推移，收益池中不断积累原生收益，从而提升 YT 可兑现价值，新质押的 SY 所铸造的 PT 会略微减少，但无论所铸造的 PT 数量是多少，锁定时间到期后，用户都能销毁当时铸造的 PT 将自己的质押的 SY 完全赎回。

一般来说，原生收益代币可以大致分类为：

1. **Rebase 代币** - 随着时间的推移而增加余额的代币

_示例：stETH, aUSDC_

2. **带奖励的非 Rebase 代币** - 随着时间的推移而增值的代币

_示例：wstETH, stone, slisBNB_

**特别需要注意的是**: 对于带奖励的非 Rebase 原生收益代币，在锁定时间到期后，仓位中的质押的原生收益代币的数量不会发生改变，但是其价值（相对于**原生代币**的交换比率）会随原生收益的积累增长，所以燃烧 PT 并不会赎回和最初质押时相同数量的非 Rebase 原生收益代币，而是会略微减少，因为其中一部分价值归属于 YT。

#### 通用资产本金代币

OutStake 的 PT 是通用资产本金代币，质押相同资产类型的原生收益代币会铸造同一种通用资产本金代币，简单讲 质押 stETH，rETH，stone 会铸造同一种 PT 代币，而非不同的 PT 代币。这样的设计可以使相同类别的原生收益代币共享 PT 的流动性，并提高其可组合性。

以 ETH 为例，当前市场上有许多与 ETH 相关的 LST，这些代币的流动性是碎片化的，并且有些代币的流动性很充足，有些代币的流动性却有些不足。一个 LST 的流动性往往与其在 DeFi 程序里的采用相关，比如 LST/ETH，LST/USDT 这些流动性池的深度。每一种 LST 的流动性积累过程都艰难。

而引入通用资产本金代币 (UETH) 则可以减少这些重复的过程。假设存在一个流动性不足的 LST 为 xETH，市场上只需要有 UETH/ETH，UETH/USDT 这样的流动性池，通过 Outstake 质押 xETH 铸造 UETH 则可以**连接市场上已经存在的流动性**，而加入越来越多的经过市场验证的 LST 则会让流动性越来越充足。

### 质押收益代币 YT

YT 代表对质押的原生收益代币的收益权，通过质押原生收益代币并指定一个锁定时间获得。YT 可以在二级市场上交易以及用于构建其他 DeFi 乐高。

#### **真正的通用同质化 YieldToken**

与目前市场上其他协议的 YT 不同，其他协议的 YT 都是 NFT 或者特殊具有各种限制的 FT，他们本质上都是非同质化的，这种特性导致了 YT 的流动性缺失，并且降低了协议的可组合性。

OutStake 的 YT 是**真正的同质化 Token (FT)**，流动性非常好，可组合性极强。每将 1 个原生收益代币锁定质押 1 天会铸造 1 个 YT，将 𝑥 个原生收益代币锁定质押 𝑦 天就会铸造 𝑥𝑦 个 YT，所以理论上 1 个 YT 锚定 1 个原生收益代币 1 天所产生的原生收益。

YT 可以自由交易，并且可以无限制地即时销毁并赎回收益池中已积累的原生收益，销毁时按销毁的 YT 数量占 YT 总量的比例赎回已产生原生收益。

#### **YT 的稳定机制**

YT 同时也是一种与原生收益率挂钩的非美元算法稳定币，理论上 1 个 YT 代表 1 个原生收益代币 1 天所产生的原生收益。由于 YT 与原生收益率挂钩，并且也是由原生收益代币质押所铸造的，不同于早期 Luna 这类算法稳定币，YT 的价值系统是一个封闭的系统，永远不会出现价格死亡螺旋的情况

在最初时，YT 的可兑现价值（销毁 YT 赎回的原生收益）在从第一个 YT 被铸造后会从零随着时间缓慢增长，理论上在达到理论价值上限时会停止增长。而燃烧 YT 会等比例赎回原生收益，所以不会影响其可兑现价值。**YT 的可兑现价值只会在铸造新的 YT 时降低**，并且降低多少在未来就会重新积累多少（因为质押了新的原生收益代币）。

然而在实际运行中，会有部分用户在其质押的原生收益代币锁定时间未到期时提前燃烧 YT，导致 YT 的流通量减少，而收益池中仍然在积累原生收益，**最终导致 YT 的可兑现价值突破理论价值上限**，从而导致后续出现两种可能情况：

1. 在未来，燃烧 YT 能赎回的收益更多，长期质押者的收益增多。
2. 用户可以质押更多原生收益代币以铸造新的 YT 并立即燃烧赎回原生收益完成套利，但是这会为下一次价值突破提供更多燃料，同时新质押所铸造的 PT 数量略微减少，导致所铸造的 POT 的隐含固定利率提高。


#### **更广阔的前景**

YT 不仅仅是帮助长期质押者获得更多收益的工具，它是一个真正的通用同质化 Yield Token，同时也是 **Web3 第一个锚定原生收益率的去中心化算法稳定币**，在市场的博弈下 YT 始终与原生收益率挂钩，在未来 Outrun 会依托 YT 的特性和社区一起构建更多有意思的产品。

#### 数学模型

YT 的机制虽然看起来很简洁，但是由于 YT 可以自由交易，并且任何持有 YT 的用户可以随时赎回原生收益，所以这其中会有一个非常复杂的博弈过程，从而引入一个极其复杂的数学模型。

下面我们构建一个**最小的模型**来计算无常损失。

假设收益池中此时的积累的原生收益为 0，我们将 1 个 YT 锚定的 1 个原生收益代币 1 天所产生的原生收益设为 _**y**_。用户 _A_ 质押了 _**a**_ 个原生收益代币并锁定 _**m**_ 天，这会铸造 _**am**_ 个 YT，我们将此时其他用户看成一个整体，这个整体看作用户 _B_ 质押了 _**b**_ 个原生收益代币并锁定 _**n**_ 天，这会铸造 _**bn**_ 个 YT。

在 _**t**_ 天之后

<p align="center">
  <img src="./assets/Profit.jpg" alt="" width="563">
</p>

用实际收益除以预期收益再减 1 可以得出无常盈亏率 **(IPnLR)**\
**_IPnLR_ = (Actual Earnings / Expected Earnings) - 1**

<p align="center">
  <img src="./assets/IPnLR.jpg" alt="" width="342">
</p>

再用 _**IPnLR**_ 乘以各自的实际收益 _**aty**_ 与 _**bty**_ 可得各自的无常盈亏 _**IPnL**_\
_**IPnLa = IPnLRa \* Expected Profit\_A**_\
_**IPnLb = IPnLRb \* Expected Profit\_B**_

<p align="center">
  <img src="./assets/IPnL.jpg" alt="" width="375">
</p>

从上图可以得出，用户 A 的与用户 B 的无常盈亏守恒，如果用户 A 与 B 锁定的时间相同，则双方都没有无常盈亏。也就是说一个用户的无常盈亏和质押池中其他用户的加权平均天数相关。

当然上面只是一个最小化模型，实际情况受到多方博弈的影响会更加复杂。所以我们会设定一个最长锁定时间限制 **MaxLockInterval**，用户锁定时间越靠近 **MaxLockInterval**，用户的 _**IL**_ 越小, _**IP**_ 越大，除此之外用户还可以通过在锁定时间到期时，立即赎回本金然后再质押铸造 **YT** 来减少 _**IL**_，获取更多 _**IP**_，当用户锁定时间为 **MaxLockInterval** 时一定不会有 _**IL**_ 。

通过上面的模型，OutStake 可以帮助长期质押者获得更多收益。我们认为原生代币质押本身致力于使原生代币背后的生态系统更去中心化与更安全，所以长期保护生态系统的用户更应该获得更多的奖励。

## Outstake 与 Pendle 的区别

目前市场上最热门原生收益质押协议是 **Pendle**，因此我们对比 OutStake 与 Pendle 的区别，看看 Oustake 有什么优势，解决了什么问题。

1. **代币类型和可组合性**:
   * **Pendle**: 铸造的 PT (Principal Token) 和 YT (Yield Token) 具有到期时间。PT 和 YT 并非通用的 ERC20 代币，而是更接近于 NFT (不可替代代币)。在整个协议的运行期间，Pendle 会为同一个原生收益代币按不同的质押到期时间部署大量的 PT 与 YT 合约，导致流动性碎片化，并且限制了 Pendle 上资产的可组合性和使用场景，尤其是 YT，其价值会在到期时归零，这进一步限制了它的使用。
   * **Outstake**: 铸造的 PT 和 YT 是通用的 ERC20 代币，没有过期时间，可以自由集成到其他 DeFi 协议中，在协议运行期间，同一个原生收益代币只有一个对应的 YT 和 PT 合约，这种设计提高了可组合性和灵活性。重要的是，Outstake 的 PT 是通用资产本金代币，允许在质押相同原生资产类型的原生收益代币时铸造相同的 PT，从而共享其流动性。此外，Outstake 的 YT 可以被视为与收益率挂钩的稳定币，允许用户对收益率进行多空操作。
2. **固定利率收益**:
   * **Pendle**: PT 的铸造数量与质押的代币数量相等，且 PT 存在随时间递减的负溢价，而固定利率收益正是来源于 PT 的负溢价，即质押用户以及购买 YT 的用户的亏损。同时要想获得固定利率，用户需购买相应的 PT。由于 PT 的负溢价，导致质押者提前卖掉 PT 时会产生亏损，因此 PT 本身的实用价值大大降低，很难集成到其他 DeFi 玩法中。
   * **Outstake**: PT 的铸造数量与用户铸造的 YT 数量和 YT 的可兑现价值相关，这避免了 PT 产生负溢价。Outstake 通过引入可交易的 POT，即原生收益代币的锁定期到期赎回权，使得用户在不交易 PT 的情况下即可获得固定利率的权利，提高了资本效率，而其收益来源于用户的需求交换，并非质押的亏损。
3. **质押时间**:
   * **Pendle**: 质押时间由协议确定，用户无法自由选择质押时间。
   * **Outstake**: 用户可以自由选择质押时间，从而控制 PT 的铸造数量。同时，质押的时间被抽象为 POT，使得仓位过期时间成为可交易资产，进一步增加了灵活性。
4. **收益来源**:
   * **Pendle**: Pendle 并没有产生真实的外部收益，其固定利率收益本质上来自于质押用户以及购买 YT 的用户的亏损。之前 Pendle 的高固定利率收益也是由于各种 Restaking 等协议的空投积分，让用户甘愿去承担亏损而去博取空投积分而造就的高固定收益，仅仅是昙花一现。
   * **Outstake**: 通过 Outrun 生态系统，支持多种资产，创造了丰富的套利市场和多种收入来源。用户除了了能获得原生收益以外，还可以通过交易 POT 获取固定利率收益，增强了协议的整体收益性与可扩展性。
